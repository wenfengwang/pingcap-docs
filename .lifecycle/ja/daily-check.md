---
title: デイリーチェック
summary: TiDBクラスターのパフォーマンス指標について学びます。
aliases: ['/docs/dev/daily-check/']
---

# デイリーチェック

TiDBは分散データベースであり、メカニズムおよびモニタリング項目に関して、単独のデータベースよりも複雑です。TiDBをより便利な方法で操作および保守するために、このドキュメントではいくつかの主要なパフォーマンス指標を紹介します。

## TiDBダッシュボードの主要指標

v4.0から、TiDBは新しい操作と保守管理ツール、[TiDBダッシュボード](/dashboard/dashboard-intro.md)を提供しています。このツールはPDコンポーネントに統合されています。TiDBダッシュボードは、デフォルトのアドレス `http://${pd-ip}:${pd_port}/dashboard` でアクセスできます。

TiDBダッシュボードは、TiDBデータベースの操作と保守を簡素化します。1つのインタフェースでTiDBクラスター全体の稼働状況を表示できます。以下は、いくつかのパフォーマンス指標の説明です。

### インスタンスパネル

![インスタンスパネル](/media/instance-status-panel.png)

+ **ステータス**: この指標はステータスが正常かどうかを確認するために使用されます。オンラインノードの場合、これは無視できます。
+ **アップタイム**: 主要な指標です。`アップタイム` が変わっている場合、コンポーネントが再起動された理由を特定する必要があります。
+ **バージョン**、**デプロイメントディレクトリ**、**Gitハッシュ**: これらの指標は、不一致または誤ったバージョン/デプロイメントディレクトリを避けるために確認する必要があります。

### ホストパネル

![ホストパネル](/media/host-panel.png)

CPU、メモリ、およびディスクの使用状況を表示できます。いずれかのリソースの使用率が80%を超える場合、適宜容量をスケーリングアウトすることを推奨します。

### SQL解析パネル

![SQL解析パネル](/media/sql-analysis-panel.png)

クラスターで実行された遅いSQLステートメントを特定できます。その後、特定のSQLステートメントを最適化できます。

### リージョンパネル

![リージョンパネル](/media/region-panel.png)

+ `miss-peer-region-count`: 十分なレプリカを持たないリージョンの数。この値が常に `0` より大きいわけではありません。
+ `extra-peer-region-count`: 追加のレプリカを持つリージョンの数。これらのリージョンはスケジューリングプロセスで生成されます。
+ `empty-region-count`: `TRUNCATE TABLE`/`DROP TABLE` ステートメントの実行によって生成された空のリージョンの数。この数が多い場合、テーブル間でリージョンをマージするために`リージョンマージ`を有効にすることを検討できます。
+ `pending-peer-region-count`: 古いRaftログを持つリージョンの数。数個の保留中のピアがスケジューリングプロセスで生成されることは正常です。ただし、この値がしばらくの間（30分より長い）大きい場合は正常ではありません。
+ `down-peer-region-count`: Raftリーダーによって応答のないピアを持つリージョンの数。
+ `offline-peer-region-count`: オフラインプロセス中のリージョンの数。

これらの値が `0` でないことは一般に正常です。ただし、長い間 `0` でないことは正常ではありません。

### KVリクエストの期間

![TiKVリクエストの期間](/media/kv-duration-panel.png)

TiKVのKVリクエスト期間99。期間が長いノードを見つけた場合、ホットスポットがあるか、またはパフォーマンスの低いノードがあるかどうかを確認してください。

### PD TSOの待機期間

![TiDB TSOの待機期間](/media/pd-duration-panel.png)

TiDBがPDからTSOを取得するのにかかる時間。長い待機期間の理由は次のとおりです。

+ TiDBからPDへの高いネットワーク遅延。ネットワーク遅延をテストするために、手動でpingコマンドを実行できます。
+ TiDBサーバーの高い負荷。
+ PDサーバーの高い負荷。

### 概要パネル

![概要パネル](/media/overview-panel.png)

負荷、利用可能なメモリ、ネットワークトラフィック、およびI/Oユーティリティを表示できます。ボトルネックが見つかった場合、適切な容量をスケーリングアウトするか、クラスタートポロジー、SQL、およびクラスターパラメータを最適化することを推奨します。

### 例外

![例外](/media/failed-query-panel.png)

各TiDBインスタンスで実行されたSQLステートメントによってトリガーされたエラーを表示できます。これには構文エラーやプライマリキーの競合が含まれます。

### GCステータス

![GCステータス](/media/garbage-collation-panel.png)

最後にGCが発生した時刻を表示して、GC（Garbage Collection）ステータスが正常かどうかを確認できます。GCが異常な場合、過剰な履歴データが発生し、アクセス効率が低下する可能性があります。