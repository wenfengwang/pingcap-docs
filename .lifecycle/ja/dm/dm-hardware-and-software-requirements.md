---
title: TiDBデータ移行のソフトウェアおよびハードウェア要件
summary: DMクラスターのソフトウェアおよびハードウェア要件を学ぶ
aliases: ['/docs/tidb-data-migration/dev/hardware-and-software-requirements/']
---

# TiDBデータ移行のソフトウェアおよびハードウェア要件

TiDBデータ移行（DM）は主要なLinuxオペレーティングシステムをサポートしています。具体的なバージョン要件については、以下の表を参照してください。

| Linux OS       | Version         |
| :----------------------- | :----------:   |
| Red Hat Enterprise Linux | 7.3 以降       |
| CentOS                   | 7.3 以降       |
| Oracle Enterprise Linux  | 7.3 以降       |
| Ubuntu LTS               | 16.04 以降    |

DMはIntelアーキテクチャサーバーおよび主要な仮想化環境で展開および実行できます。

## 推奨サーバー要件

DMは64ビットの汎用ハードウェアサーバープラットフォーム（Intel x86-64アーキテクチャ）で展開および実行できます。開発、テスト、および本番環境で使用されるサーバーについては、このセクションで推奨されるハードウェア構成を示します（これにはオペレーティングシステムで使用されるリソースは含まれません）。

### 開発およびテスト環境

| コンポーネント | CPU | メモリ | ローカルストレージ | ネットワーク | インスタンス数（最小要件） |
| --- | --- | --- | --- | --- | --- |
| DM-master | 4コア以上 | 8 GB以上 | SAS、200 GB以上 | ギガビットネットワークカード | 1 |
| DM-worker | 8コア以上 | 16 GB以上 | SAS、200 GB以上（移行データのサイズより大きい） | ギガビットネットワークカード | 上流MySQLインスタンスの数 |

> **注:**
>
> - テスト環境では、機能検証に使用されるDM-masterおよびDM-workerは同じサーバーに展開できます。
> - パフォーマンステスト結果の精度に干渉しないようにするため、低性能なストレージおよびネットワークハードウェア構成を使用することは**推奨されません**。
> - 機能の検証のみが必要な場合、DM-masterを単一のマシンに展開できます。展開されるDM-workerの数は、上流MySQLインスタンスの数以上である必要があります。高可用性を確保するためには、より多くのDM-workerを展開することを推奨します。
> - DM-workerは`dump`および`load`フェーズで完全なデータを保存します。したがって、DM-workerのディスクスペースは移行されるデータの合計量よりも大きくする必要があります。移行タスクでリレーログが有効になっている場合、DM-workerには上流バイナリログデータを保存するための追加のディスクスペースが必要です。

### 本番環境

| コンポーネント | CPU | メモリ | ハードディスクタイプ | ネットワーク | インスタンス数（最小要件） |
| --- | --- | --- | --- | --- | --- |
| DM-master | 4コア以上 | 8 GB以上 | SAS、200 GB以上 | ギガビットネットワークカード | 3 |
| DM-worker | 16コア以上 | 32 GB以上 | SSD、200 GB以上（移行データのサイズより大きい） | 10ギガビットネットワークカード | 上流MySQLインスタンスの数以上 |
| Monitor | 8コア以上 | 16 GB以上 | SAS、200 GB以上 | ギガビットネットワークカード | 1 |

> **注:**
>
> - 本番環境では、DM-masterおよびDM-workerを同じサーバーに展開および実行することは推奨されません。DM-workerがデータをディスクに書き込む際に、DM-masterの高可用性コンポーネントがディスクの使用に干渉する可能性があります。
> - パフォーマンスの問題が発生した場合、[DMの設定の最適化](/dm/dm-tune-configuration.md)ドキュメントに従ってタスク設定ファイルを変更することをお勧めします。構成ファイルを調整してもパフォーマンスが十分に最適化されない場合は、サーバーのハードウェアをアップグレードすることを試してみてください。

## ダウンストリームストレージスペース要件

対象のTiKVクラスターには、インポートされたデータを保存するための十分なディスク容量が必要です。[標準ハードウェア要件](/hardware-and-software-requirements.md)に加えて、対象のTiKVクラスターのストレージスペースは、**データソースのサイズ×レプリカの数×2**よりも大きくなければなりません。たとえば、クラスターがデフォルトで3つのレプリカを使用する場合、対象のTiKVクラスターはデータソースのサイズの6倍以上のストレージスペースを持っていなければなりません。この式には`× 2`が含まれています。なぜならば：

- インデックスには余分なスペースが必要です。
- RocksDBにはスペースの拡張効果があります。

`DATA_LENGTH`フィールドを集計するために、以下のSQLステートメントを使用してデータボリュームを見積もることができます：

```sql
-- すべてのスキーマのサイズを計算
SELECT
  TABLE_SCHEMA,
  FORMAT_BYTES(SUM(DATA_LENGTH)) AS 'データサイズ',
  FORMAT_BYTES(SUM(INDEX_LENGTH)) 'インデックスサイズ'
FROM
  information_schema.tables
GROUP BY
  TABLE_SCHEMA;

-- 上位5つのテーブルのサイズを計算
SELECT 
  TABLE_NAME,
  TABLE_SCHEMA,
  FORMAT_BYTES(SUM(data_length)) AS 'データサイズ',
  FORMAT_BYTES(SUM(index_length)) AS 'インデックスサイズ',
  FORMAT_BYTES(SUM(data_length+index_length)) AS '合計サイズ'
FROM
  information_schema.tables
GROUP BY
  TABLE_NAME,
  TABLE_SCHEMA
ORDER BY
  SUM(DATA_LENGTH+INDEX_LENGTH) DESC
LIMIT
  5;
```