---
title: 3つのデータセンター展開におけるローカルリード
summary: ステールリード機能を使用して、3つのデータセンター展開下でのローカルデータの読み取り方法を学び、それによってクロスセンターリクエストを減らします。

# 3つのデータセンター展開におけるローカルリード

3つのデータセンターモデルでは、リージョンにはそれぞれのデータセンターに分散された3つのレプリカがあります。ただし、強力な一貫性のリードが必要な要件のため、TiDBはクエリごとに対応するデータのリーダーレプリカにアクセスする必要があります。クエリがリーダーレプリカのデータセンターと異なるデータセンターで生成された場合、TiDBは別のデータセンターからデータを読み取る必要があり、それによりアクセスの遅延が発生します。

このドキュメントでは、[ステールリード](/stale-read.md)機能を使用して、リアルタイムデータの利用可能性を犠牲にしてクロスセンターアクセスを回避し、アクセスの遅延を減らす方法について説明します。

## 3つのデータセンター展開のTiDBクラスターを展開する

3つのデータセンター展開方法については、[同一都市内の複数のデータセンター展開](/multi-data-centers-in-one-city-deployment.md)を参照してください。

TiKVおよびTiDBノードの両方が`labels`構成項目を持っている場合、同じデータセンター内のTiKVおよびTiDBノードは`zone`ラベルの値を持っている必要があります。たとえば、TiKVノードとTiDBノードがともにデータセンター`dc-1`にある場合、2つのノードは次のラベルで構成する必要があります。

```
[labels]
zone=dc-1
```

## ステールリードを使用したローカルリードの実行

[ステールリード](/stale-read.md)は、TiDBがユーザーに提供する過去のデータの読み取りメカニズムです。このメカニズムを使用すると、特定の時点または指定された時間範囲内の対応する過去データを読み取り、それによってストレージノード間のデータレプリケーションによってもたらされる遅延を節約できます。ジオ分散展開のいくつかのシナリオでステールリードを使用する場合、TiDBはクエリプロセス全体のアクセスの遅延を減らし、一部のリアルタイムパフォーマンスを犠牲にして、対応するデータを現在のデータセンター内のレプリカにアクセスすることにより、クロスセンター接続によるネットワーク遅延を避けます。

TiDBがステールリードクエリを受信した場合、そのTiDBノードの`zone`ラベルが構成されており、[`tidb_replica_read`](/system-variables.md#tidb_replica_read-new-in-v40)が`closest-replicas`に設定されている場合、TiDBは対応するデータレプリカが存在する同じ`zone`ラベルを持つTiKVノードにリクエストを送信します。

ステールリードの実行方法については、[`AS OF TIMESTAMP`句を使用したステールリードの実行](/as-of-timestamp.md)を参照してください。
