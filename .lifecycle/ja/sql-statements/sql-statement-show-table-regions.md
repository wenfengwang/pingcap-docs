---
title: SHOW TABLE REGIONS
summary: テーブルの領域情報を表示する方法を学びます。
aliases: ['/docs/dev/sql-statements/sql-statement-show-table-regions/','/docs/dev/reference/sql/statements/show-table-regions/']
---

# SHOW TABLE REGIONS

`SHOW TABLE REGIONS` ステートメントは、TiDBのテーブルのリージョン情報を表示するために使用されます。

> **Note:**
>
> この機能は、[TiDB Serverless](https://docs.pingcap.com/tidbcloud/select-cluster-tier#tidb-serverless) クラスターでは利用できません。

## 構文

```sql
SHOW TABLE [table_name] REGIONS [WhereClauseOptional];
SHOW TABLE [table_name] INDEX [index_name] REGIONS [WhereClauseOptional];
```

## 概要

**ShowTableRegionStmt:**

![ShowTableRegionStmt](/media/sqlgram/ShowTableRegionStmt.png)

**TableName:**

![TableName](/media/sqlgram/TableName.png)

**PartitionNameListOpt:**

![PartitionNameListOpt](/media/sqlgram/PartitionNameListOpt.png)

**WhereClauseOptional:**

![WhereClauseOptional](/media/sqlgram/WhereClauseOptional.png)

**WhereClause:**

![WhereClause](/media/sqlgram/WhereClause.png)

`SHOW TABLE REGIONS` を実行すると、次の列が返されます。

* `REGION_ID`: リージョンID。
* `START_KEY`: リージョンの開始キー。
* `END_KEY`: リージョンの終了キー。
* `LEADER_ID`: リージョンのリーダーID。
* `LEADER_STORE_ID`: リージョンのリーダーが配置されているストア（TiKV）のID。
* `PEERS`: すべてのリージョンレプリカのID。
* `SCATTERING`: リージョンがスケジュールされているかどうか。`1` は true を示します。
* `WRITTEN_BYTES`: リージョンに1つのハートビートサイクル内で書き込まれたデータの推定量。単位はバイトです。
* `READ_BYTES`: リージョンから1つのハートビートサイクル内で読まれたデータの推定量。単位はバイトです。
* `APPROXIMATE_SIZE(MB)`: リージョン内のデータの推定量。単位はメガバイト（MB）です。
* `APPROXIMATE_KEYS`: リージョン内のキーの推定数。

<CustomContent platform="tidb">

* `SCHEDULING_CONSTRAINTS`: リージョンが属するテーブルまたはパーティションに関連する[配置ポリシー設定](/placement-rules-in-sql.md)。

</CustomContent>

<CustomContent platform="tidb-cloud">

* `SCHEDULING_CONSTRAINTS`: リージョンが属するテーブルまたはパーティションに関連する配置ポリシー設定。

</CustomContent>

* `SCHEDULING_STATE`: 配置ポリシーを持つリージョンのスケジューリング状態。

> **Note:**
>
> `WRITTEN_BYTES`、`READ_BYTES`、`APPROXIMATE_SIZE(MB)`、`APPROXIMATE_KEYS` の値は正確なデータではありません。これらは、PDがリージョンから受信するハートビート情報に基づく推定データです。

## 例

いくつかのリージョンを満たす十分なデータを持つ例のテーブルを作成します：

{{< copyable "sql" >}}

```sql
CREATE TABLE t1 (
 id INT NOT NULL PRIMARY KEY auto_increment,
 b INT NOT NULL,
 pad1 VARBINARY(1024),
 pad2 VARBINARY(1024),
 pad3 VARBINARY(1024)
);
INSERT INTO t1 SELECT NULL, FLOOR(RAND()*1000), RANDOM_BYTES(1024), RANDOM_BYTES(1024), RANDOM_BYTES(1024) FROM dual;
INSERT INTO t1 SELECT NULL, FLOOR(RAND()*1000), RANDOM_BYTES(1024), RANDOM_BYTES(1024), RANDOM_BYTES(1024) FROM t1 a JOIN t1 b JOIN t1 c LIMIT 10000;
INSERT INTO t1 SELECT NULL, FLOOR(RAND()*1000), RANDOM_BYTES(1024), RANDOM_BYTES(1024), RANDOM_BYTES(1024) FROM t1 a JOIN t1 b JOIN t1 c LIMIT 10000;
...

mysql> SHOW TABLE t1 REGIONS;
+-----------+--------------+--------------+-----------+-----------------+-------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| REGION_ID | START_KEY    | END_KEY      | LEADER_ID | LEADER_STORE_ID | PEERS | SCATTERING | WRITTEN_BYTES | READ_BYTES | APPROXIMATE_SIZE(MB) | APPROXIMATE_KEYS | SCHEDULING_CONSTRAINTS | SCHEDULING_STATE |
+-----------+--------------+--------------+-----------+-----------------+-------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
|        94 | t_75_        | t_75_r_31717 |        95 |               1 | 95    |          0 |             0 |          0 |                  112 |           207465 |                        |                  |
|        96 | t_75_r_31717 | t_75_r_63434 |        97 |               1 | 97    |          0 |             0 |          0 |                   97 |                0 |                        |                  |
|         2 | t_75_r_63434 |              |         3 |               1 | 3     |          0 |     269323514 |   66346110 |                  245 |           162020 |                        |                  |
+-----------+--------------+--------------+-----------+-----------------+-------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
3 rows in set (0.00 sec)
```

上記の出力では、`START_KEY` が `t_75_r_31717` で、`END_KEY` が `t_75_r_63434` であることから、`31717` から `63434` の間の主キーを持つデータがこのリージョンに格納されていることが示されています。`t_75_` の接頭辞は、`t` という表のリージョンであり、内部表IDが `75` であることを示します。`START_KEY` や `END_KEY` の空のキー値はそれぞれ負の無限大または正の無限大を示します。

TiDBは必要に応じて自動的にリージョンを再バランスします。手動での再バランスには、`SPLIT TABLE REGION` ステートメントを使用します：

```sql
mysql> SPLIT TABLE t1 BETWEEN (31717) AND (63434) REGIONS 2;
+--------------------+----------------------+
| TOTAL_SPLIT_REGION | SCATTER_FINISH_RATIO |
+--------------------+----------------------+
|                  1 |                    1 |
+--------------------+----------------------+
1 row in set (42.34 sec)

mysql> SHOW TABLE t1 REGIONS;
+-----------+--------------+--------------+-----------+-----------------+-------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| REGION_ID | START_KEY    | END_KEY      | LEADER_ID | LEADER_STORE_ID | PEERS | SCATTERING | WRITTEN_BYTES | READ_BYTES | APPROXIMATE_SIZE(MB) | APPROXIMATE_KEYS | SCHEDULING_CONSTRAINTS | SCHEDULING_STATE |
|        94 | t_75_        | t_75_r_31717 |        95 |               1 | 95    |          0 |             0 |          0 |                  112 |           207465 |                        |                  |
|        98 | t_75_r_31717 | t_75_r_47575 |        99 |               1 | 99    |          0 |          1325 |          0 |                   53 |            12052 |                        |                  |
|        96 | t_75_r_47575 | t_75_r_63434 |        97 |               1 | 97    |          0 |          1526 |          0 |                   48 |                0 |                        |                  |
|         2 | t_75_r_63434 |              |         3 |               1 | 3     |          0 |             0 |   55752049 |                   60 |                0 |                        |                  |
+-----------+--------------+--------------+-----------+-----------------+-------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
4 行が設定されました(0.00 秒)

この出力によると、リージョン96が分割され、新たなリージョン98が作成されました。テーブル内の残りのリージョンは分割操作によって影響を受けませんでした。このことは、出力統計によって確認されます。

* `TOTAL_SPLIT_REGION` は、新たに分割されたリージョンの数を示します。この例では、その数は1です。
* `SCATTER_FINISH_RATIO` は、新たに分割されたリージョンが正常に分散される割合を示します。`1.0` は、すべてのリージョンが分散されたことを意味します。

詳細な例:

```sql
mysql> show table t regions;
+-----------+--------------+--------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| REGION_ID | START_KEY    | END_KEY      | LEADER_ID | LEADER_STORE_ID | PEERS         | SCATTERING | WRITTEN_BYTES | READ_BYTES | APPROXIMATE_SIZE(MB) | APPROXIMATE_KEYS | SCHEDULING_CONSTRAINTS | SCHEDULING_STATE |
+-----------+--------------+--------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| 102       | t_43_r       | t_43_r_20000 | 118       | 7               | 105, 118, 119 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 106       | t_43_r_20000 | t_43_r_40000 | 120       | 7               | 107, 108, 120 | 0          | 23            | 0          | 1                    | 0                |                        |                  |
| 110       | t_43_r_40000 | t_43_r_60000 | 112       | 9               | 112, 113, 121 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 114       | t_43_r_60000 | t_43_r_80000 | 122       | 7               | 115, 122, 123 | 0          | 35            | 0          | 1                    | 0                |                        |                  |
| 3         | t_43_r_80000 |              | 93        | 8               | 5, 73, 93     | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 98        | t_43_        | t_43_r       | 99        | 1               | 99, 100, 101  | 0          | 0             | 0          | 1                    | 0                |                        |                  |
+-----------+--------------+--------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
6 行が設定されました

上記の例では:

* テーブル t に対応する 6 つのリージョンがあります。このリージョンのうち、`102`、`106`、`110`、`114`、`3` は行データを保存し、`98` はインデックスデータを保存しています。
* リージョン `102` の `START_KEY` と `END_KEY` には、`t_43` がテーブルの接頭辞と ID を示しています。`_r` はテーブル t のレコードデータの接頭辞です。`_i` はインデックスデータの接頭辞です。
* リージョン `102` における `START_KEY` と `END_KEY` は、範囲 `[-inf, 20000)` のデータ保存を意味します。同様に、リージョン (`106`、`110`、`114`、`3`) のデータ保存範囲も計算できます。
* リージョン `98` はインデックスデータを保存しています。テーブル t のインデックスデータの開始キーは `t_43_i` であり、これはリージョン `98` の範囲内にあります。

ストア 1 におけるテーブル t に対応するリージョンを確認するには、`WHERE` 句を使用します:

```sql
test> show table t regions where leader_store_id =1;
+-----------+-----------+---------+-----------+-----------------+--------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| REGION_ID | START_KEY | END_KEY | LEADER_ID | LEADER_STORE_ID | PEERS        | SCATTERING | WRITTEN_BYTES | READ_BYTES | APPROXIMATE_SIZE(MB) | APPROXIMATE_KEYS | SCHEDULING_CONSTRAINTS | SCHEDULING_STATE |
+-----------+-----------+---------+-----------+-----------------+--------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| 98        | t_43_     | t_43_r  | 99        | 1               | 99, 100, 101 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
+-----------+-----------+---------+-----------+-----------------+--------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
```

`SPLIT TABLE REGION` を使用して、テーブル t のインデックスデータをリージョンに分割します。次の例では、テーブル t のインデックスデータ `name` が、範囲 `[a,z]` の 2 つのリージョンに分割されます。

```sql
test> split table t index name between ("a") and ("z") regions 2;
+--------------------+----------------------+
| TOTAL_SPLIT_REGION | SCATTER_FINISH_RATIO |
+--------------------+----------------------+
| 2                  | 1.0                  |
+--------------------+----------------------+
1 行が設定されました

ここで、テーブル t は 7 つのリージョンに対応します。そのうち、5 つ (`102`、`106`、`110`、`114`、`3`) はテーブル t のレコードデータを保存し、他の 2 つ (`135`、`98`) はインデックスデータ `name` を保存しています。

```sql
test> show table t regions;
+-----------+-----------------------------+-----------------------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| REGION_ID | START_KEY                   | END_KEY                     | LEADER_ID | LEADER_STORE_ID | PEERS         | SCATTERING | WRITTEN_BYTES | READ_BYTES | APPROXIMATE_SIZE(MB) | APPROXIMATE_KEYS | SCHEDULING_CONSTRAINTS | SCHEDULING_STATE |
+-----------+-----------------------------+-----------------------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
| 102       | t_43_r                      | t_43_r_20000                | 118       | 7               | 105, 118, 119 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 106       | t_43_r_20000                | t_43_r_40000                | 120       | 7               | 108, 120, 126 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 110       | t_43_r_40000                | t_43_r_60000                | 112       | 9               | 112, 113, 121 | 0          | 0             | 0          | 1                    | 0                |                        |                  |
| 114       | t_43_r_60000                | t_43_r_80000                | 122       | 7               | 115, 122, 123 | 0          | 35            | 0          | 1                    | 0                |                        |                  |
| 3         | t_43_r_80000                |                             | 93        | 8               | 73, 93, 128   | 0          | 0             | 0          | 1                    | 0                |                        |                  |
```
+-----------+-----------------------------+-----------------------------+-----------+-----------------+---------------+------------+---------------+------------+----------------------+------------------+------------------------+------------------+
7 行 セット
```

## MySQL 互換性

このステートメントはMySQLの構文にTiDB拡張です。

## 関連情報

* [SPLIT REGION](/sql-statements/sql-statement-split-region.md)
* [CREATE TABLE](/sql-statements/sql-statement-create-table.md)