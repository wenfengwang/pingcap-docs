---
title: PDの主要なモニタリングメトリクス
summary: Grafana PDダッシュボードに表示される主要なメトリクスについて学びましょう。
aliases: ['/docs/jp/dev/grafana-pd-dashboard/', '/docs/jp/dev/reference/key-monitoring-metrics/pd-dashboard/']
---

# PDの主要なモニタリングメトリクス

TiUPを使用してTiDBクラスタをデプロイした場合、監視システム（Prometheus & Grafana）も同時にデプロイされます。詳細については、「[監視フレームワークの概要](/tidb-monitoring-framework.md)」を参照してください。

Grafanaダッシュボードは、概要、PD、TiDB、TiKV、Node\_exporter、ディスクパフォーマンス、パフォーマンスの概要など、一連のサブダッシュボードに分かれています。診断のために多くのメトリクスが用意されています。

PDダッシュボードでは、キーとなるメトリクスが表示され、TiDBクラスタのPDコンポーネントの状態の概要を把握することができます。このドキュメントでは、これらのキーとなるメトリクスの詳細な説明が提供されます。

以下は、PDダッシュボードのメトリクス項目の説明です:

- PDの役割: 現在のPDインスタンスの役割
- ストレージ容量: このTiDBクラスタの総ストレージ容量
- 現在のストレージサイズ: TiDBクラスタが現在使用しているストレージサイズ
- 現在のストレージ使用率: 現在のストレージ使用率
- 正常なストア: 健全なストレージインスタンスの数
- リージョンの数: クラスタ内のリージョンの総数
- 異常なストア: 異常なストアの数です。正常な値は `0` です。もし数が `0` よりも大きければ、少なくとも1つのインスタンスが異常です。
- リージョンの状態: リージョンの状態は、保留中のピア、停止中のピア、余分なピア、オフラインのピア、不足しているピア、学習中のピア、不正なネームスペースを含む異常なリージョンの数を示します。一般的に、保留中のピアの数は `100` よりも少なくなるべきです。不足しているピアの数が `0` を持続的に超えるべきではありません。空のリージョンが多数存在する場合は、リージョンのマージをタイムリーに有効にしてください。
- 現在のピア数: クラスタ内の現在の全ピア数

![PDダッシュボード - ヘッダー](/media/pd-dashboard-header-v4.png)

## キーメトリクスの説明

## クラスタ

- PDスケジューラの設定: PDスケジューラの設定の一覧
- クラスタID: クラスタの一意の識別子
- 現在のTSO: 現在の割り当てられたTSOの物理部分
- 現在のID割り当て: 新しいストア/ピアに割り当て可能な最大のID
- リージョンラベルの分離レベル: 異なるラベルレベルのリージョンの数
- ラベルの分布: クラスタ内のラベルの分布状況
- ストア制限: ストアへのスケジューリングのフロー制御制限

![PDダッシュボード - クラスタメトリクス](/media/pd-dashboard-cluster-v4.png)

## オペレーター

- スケジュールオペレーターの作成: タイプごとの新しく作成されたオペレーターの数
- スケジュールオペレーターのチェック: タイプごとのチェックされたオペレーターの数。主に現在のステップが完了しているかどうかをチェックし、完了している場合は次のステップを実行します
- スケジュールオペレーターの完了: タイプごとの完了したオペレーターの数
- スケジュールオペレーターのタイムアウト: タイプごとのタイムアウトしたオペレーターの数
- スケジュールオペレーターの置換またはキャンセル: タイプごとの置換またはキャンセルされたオペレーターの数
- ステートごとのオペレーターカウント: ステートごとのオペレーターの数
- オペレーターの完了時間: 完了したオペレーターの最大時間
- オペレーターステップの所要時間: 完了したオペレーターステップの最大所要時間

![PDダッシュボード - オペレーターメトリクス](/media/pd-dashboard-operator-v4.png)

## 統計 - バランス

- ストア容量: 各TiKVインスタンスごとの容量サイズ
- ストアの利用可能容量: 各TiKVインスタンスごとの利用可能な容量サイズ
- ストアの使用済み容量: 各TiKVインスタンスごとの使用済み容量サイズ
- サイズ増幅率: 各TiKVインスタンスごとのサイズ増幅比（(ストアリージョンサイズ)/(ストア使用済み容量サイズ)）
- サイズの利用可能率: 各TiKVインスタンスごとの利用可能なサイズの利用率（(ストア利用可能容量サイズ)/(ストア容量サイズ)）
- ストアリーダースコア: 各TiKVインスタンスごとのリーダースコア
- ストアリージョンスコア: 各TiKVインスタンスごとのリージョンスコア
- ストアリーダーサイズ: 各TiKVインスタンスごとのリーダーサイズの合計
- ストアリージョンサイズ: 各TiKVインスタンスごとのリージョンサイズの合計
- ストアリーダーカウント: 各TiKVインスタンスごとのリーダーカウント
- ストアリージョンカウント: 各TiKVインスタンスごとのリージョンカウント

![PDダッシュボード - バランスメトリクス](/media/pd-dashboard-balance-v4.png)

## 統計 - ホットライト

- ホットリージョンのリーダーの分布: 各TiKVインスタンス上でライトホットスポットとなったリーダーリージョンの総数
- ホットリーダーリージョンの合計書き込みバイト数: 各TiKVインスタンス上のライトホットスポットとなったリーダーリージョンによって書き込まれた合計バイト数
- ホットライトリージョンのピアの分布: 各TiKVインスタンスでライトホットスポットとなったピアリージョンの総数
- ホットピアリージョンの合計書き込みバイト数: 各TiKVインスタンス上のライトホットスポットとなったすべてのピアリージョンの書き込みバイト数
- ストアの書き込みレートバイト数: 各TiKVインスタンス上の書き込みバイト数の合計
- ストアの書き込みレートキー数: 各TiKVインスタンス上の書き込みキー数の合計
- ホットキャッシュ書き込みエントリー数: ホットスポットスケジューリングモジュールに含まれる各TiKVインスタンス上のピアの数
- セレクタのイベント数: ホットスポットスケジューリングモジュール内のセレクタのイベント数
- ホットスポット移動リーダーの方向: ホットスポットスケジューリング中のリーダーの移動方向。正の数はインスタンスに対するスケジューリングを意味し、負の数はインスタンスからのスケジューリングを意味します
- ホットスポット移動ピアの方向: ホットスポットスケジューリング中のピアの移動方向。正の数はインスタンスに対するスケジューリングを意味し、負の数はインスタンスからのスケジューリングを意味します

![PDダッシュボード - ホットライトメトリクス](/media/pd-dashboard-hotwrite-v4.png)

## 統計 - ホットリード

- ホットリージョンのピアの分布: 各TiKVインスタンス上のリードホットスポットとなったピアリージョンの総数
- ホットピアリージョンの合計リードバイト数: リードホットスポットとなったピアリージョンの合計リードバイト数
- ストアのリードレートバイト数: 各TiKVインスタンス上のリードバイト数の合計
- ストアのリードレートキー数: 各TiKVインスタンス上のリードキー数の合計
- ホットキャッシュリードエントリー数: readホットスポット統計モジュールに含まれる各TiKVインスタンス上のピアの数

![PDダッシュボード - ホットリードメトリクス](/media/pd-dashboard-hotread-v4.png)

## スケジューラ

- スケジューラが実行中: 現在実行中のスケジューラ
- リーダーモvementのバランス: タイKVインスタンス間のリーダーモvementの詳細
- リージョンmovementのバランス: タイKVインスタンス間のリージョンmovementの詳細
- リーダーイベントのバランス: バランスリーダーイベントの数
- リージョンイベントのバランス: バランスリージョンイベントの数
- バランスリーダースケジューラ: バランスリーダースケジューラの内部状態
- バランスリージョンスケジューラ: バランスリージョンスケジューラの内部状態
- レプリカチェッカー: レプリカチェッカーのステータス
- ルールチェッカー: ルールチェッカーのステータス
- リージョンマージチェッカー: マージチェッカーのステータス
- ターゲットのフィルタリング: フィルタをパスできなかった場合に、ストアがスケジューリングのターゲットとして選択された試行回数の数
- ソースのフィルタリング: フィルタをパスできなかった場合に、ストアがスケジューリングのソースとして選択された試行回数の数
- バランスの方向: スケジューリングの対象またはソースとしてストアが選択された回数

![PDダッシュボード - スケジューラメトリクス](/media/pd-dashboard-scheduler-v4.png)

## gRPC

- 完了したコマンドの実行レート: gRPCコマンドの実行完了率（コマンドタイプごと）
- 99% 完了したコマンドの所要時間: gRPCコマンドの実行完了率（コマンドタイプごと）（P99）

![PDダッシュボード - gRPCメトリクス](/media/pd-dashboard-grpc-v2.png)

## etcd

- 処理されたトランザクション数: etcdがトランザクションを処理するレート
- 99% トランザクション処理の時間: トランザクション処理のレート（P99）
- 99% WAL fsyncの処理時間: WALを永続化ストレージに書き込むために必要な時間。`1s` よりも少ない（P99）
- 99% ピアのラウンドトリップ時間（秒）: etcdのネットワークレイテンシ（P99） | 値は `1s` よりも小さい
- etcdディスクWAL fsyncレート: WALを永続化ストレージに書き込むレート
- Raftのターム: Raftの現在のターム
- Raftのコミットされたインデックス: Raftの最後にコミットされたインデックス
- Raftの適用されたインデックス: Raftの最後に適用されたインデックス

![PDダッシュボード - etcdメトリクス](/media/pd-dashboard-etcd-v2.png)

## TiDB

- PDサーバーのTSO処理時間およびクライアント受信時間: PDがTSOリクエストを受信してPDクライアントがTSOレスポンスを受信するまでの所要時間
- 処理されたリクエストの数: TiDBリクエストの数
- リクエストの処理所要時間: TiDBリクエストの処理に要する時間。 `100ms` 以下であるべき（P99）

![PDダッシュボード - TiDBメトリクス](/media/pd-dashboard-tidb-v4.png)

## Heartbeat

- ハートビートリージョンイベントのQPS: キャッシュの更新とデータの永続化を含むハートビートメッセージの処理のQPS
- ハートビートリージョンのレポート: 各インスタンスごとにPDに報告されたハートビートの数
- ハートビートレポートエラーのリージョン: `error` ステータスのハートビートの数
- ハートビートレポートアクティブのリージョン: `ok` ステータスのハートビートの数
- リージョンスケジュールのプッシュ: PDから各TiKVインスタンスに送信される対応するスケジュールコマンドの数
- 99% ハートビートの待機レイテンシ: 各TiKVインスタンスのハートビートの待機レイテンシ（P99）

![PDダッシュボード - Heartbeatメトリクス](/media/pd-dashboard-heartbeat-v4.png)

## リージョンストレージ

- Syncerインデックス: 関連するリーダーが記録したリージョンの変更履歴の最大インデックス
- 履歴の最終インデックス：地域変更履歴がフォロワーと正常に同期された最後のインデックス

![PDダッシュボード - 地域ストレージ](/media/pd-dashboard-region-storage.png)