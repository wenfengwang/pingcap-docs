---
title: TiUP トラブルシューティングガイド
summary: TiUPを使用する際に問題が発生した場合のトラブルシューティング方法と解決策を紹介します。
aliases: ['/docs/dev/tiup/tiup-troubleshooting-guide/']
---

# TiUP トラブルシューティングガイド

このドキュメントでは、TiUPを使用する際に遭遇する一般的な問題とそのトラブルシューティング方法について紹介します。もし本ドキュメントに記載されていない問題に遭遇した場合は、[Github TiUPリポジトリ](https://github.com/pingcap/tiup/issues) で新しい問題を登録してください。

## TiUPコマンドのトラブルシューティング

### `tiup list` を使用して最新のコンポーネントリストが表示されない

TiUPはミラーサーバーから常に最新のコンポーネントリストを取得しないため、`tiup list` を実行してコンポーネントリストを強制的に更新することができます。

### `tiup list <component>` を使用してコンポーネントの最新バージョン情報が表示されない

前述の問題と同様に、コンポーネントのバージョン情報はローカルキャッシュがない場合にのみミラーサーバーから取得されます。`tiup list <component>` を実行してコンポーネントリストを更新することができます。

### コンポーネントのダウンロードプロセスが中断される

不安定なネットワークによってコンポーネントのダウンロードプロセスが中断されることがあります。コンポーネントをもう一度ダウンロードしてみてください。複数回試してもダウンロードできない場合は、CDNサーバーの問題が考えられます。[こちら](https://github.com/pingcap/tiup/issues) で問題を報告することができます。

### コンポーネントのダウンロード中にチェックサムエラーが発生する

CDNサーバーのキャッシュ時間が短いため、新しいチェックサムファイルがコンポーネントパッケージと一致しないことがあります。5分後にもう一度ダウンロードしてみてください。新しいチェックサムファイルがコンポーネントパッケージと一致しない場合は、[こちら](https://github.com/pingcap/tiup/issues) で問題を報告してください。

## TiUPクラスターコンポーネントのトラブルシューティング

### デプロイ中に `unable to authenticate, attempted methods [none publickey]` とプロンプトされる

デプロイ中、コンポーネントパッケージがリモートホストにアップロードされ、初期化が実行されます。このプロセスではリモートホストに接続する必要があります。このエラーは、リモートホストに接続するためのSSHプライベートキーが見つからないことによって発生します。

この問題を解決するには、`tiup cluster deploy -i identity_file` を実行してプライベートキーを指定したかどうかを確認してください：

- `-i` フラグが指定されていない場合、TiUPが自動的にプライベートキーのパスを見つけられなかった可能性があります。`-i` を使用してプライベートキーのパスを明示的に指定することをお勧めします。
- `-i` フラグが指定されている場合、指定したプライベートキーを使用してリモートホストにログインできない可能性があります。`ssh -i identity_file user@remote` コマンドを手動で実行して確認できます。
- リモートホストにログインする際にパスワードを使用する場合は、`-p` フラグを指定し、正しいログインパスワードを入力したことを確認してください。

### TiUPクラスターコンポーネントを使用してクラスターをアップグレードするプロセスが中断される

誤用を防ぐため、TiUPクラスターコンポーネントは指定されたノードのアップグレードをサポートしていないため、アップグレードが失敗した場合は、アップグレード操作を再実行する必要があります。アップグレードプロセス中に冪等性の操作を含め、もう一度実行してください。

アップグレードプロセスは以下の手順に分けることができます：

1. 全てのノードで古いバージョンのコンポーネントをバックアップ
2. 新しいコンポーネントをリモートに配布
3. 全てのコンポーネントに対してローリングリスタートを実行

もしローリングリスタート中にアップグレードが中断された場合、`tiup cluster upgrade` 操作を繰り返す代わりに、未完了のノードを再起動するには `tiup cluster restart -N <node1> -N <node2>` を使用することができます。

同じコンポーネントの未再起動ノードが比較的多い場合、`tiup cluster restart -R <component>` を実行して特定のタイプのコンポーネントを再起動することもできます。

### アップグレード中に `node_exporter-9100.service/blackbox_exporter-9115.service` が存在しないことがわかった場合

以前 TiDB Ansible からクラスターを移行し、エクスポーターが TiDB Ansible にデプロイされていなかった場合、この状況が発生する可能性があります。解決するには、一旦他のノードから不足しているファイルを手動で新しいノードにコピーすることができます。TiUPチームは移行プロセス中に不足しているコンポーネントを補完します。