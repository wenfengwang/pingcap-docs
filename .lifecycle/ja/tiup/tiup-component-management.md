---
title: TiUPコマンドを使用してTiUPコンポーネントを管理する
summary: TiUPコマンドを使用してTiUPエコシステム内のコンポーネントを管理する方法について学びます。
aliases: ['/tidb/dev/manage-tiup-component','/docs/dev/tiup/manage-tiup-component/','/docs/dev/reference/tools/tiup/manage-component/']
---

# TiUPコマンドを使用してTiUPコンポーネントを管理する

TiUPエコシステム内のコンポーネントを管理するためには、次のTiUPコマンドを使用できます。

- list: コンポーネントリストを照会します。このTiUPコマンドを使用することで、インストール可能なすべてのオプションコンポーネントと各コンポーネントのオプションバージョンを確認できます。
- install: 特定のバージョンのコンポーネントをインストールします。
- update: コンポーネントを最新バージョンに更新します。
- uninstall: コンポーネントをアンインストールします。
- status: 実行中のコンポーネントのステータスを確認します。
- clean: コンポーネントが展開されているインスタンスをクリーンアップします。
- help: ヘルプ情報を印刷します。このコマンドに別のTiUPコマンドを追加すると、追加されたコマンドの使用法が印刷されます。
- link: コンポーネントのバイナリを実行可能ディレクトリ（`$TIUP_HOME/bin/`）にリンクします。
- unlink: `tiup link`コマンドによって生成されたソフトリンクを削除します。

このドキュメントでは、一般的なコンポーネント管理の操作とそれに対応するTiUPコマンドについて紹介します。

## コンポーネントリストを照会する

`tiup list`コマンドを使用してコンポーネントリストを照会できます。このコマンドの使用法は次のとおりです:

- `tiup list`: インストール可能なコンポーネントを確認します。
- `tiup list ${component}`: 特定のコンポーネントのインストール可能なバージョンを確認します。

上記のコマンドには、次のフラグも使用できます:

- `--installed`: ローカルにインストールされているコンポーネントまたは特定のコンポーネントのバージョンを確認します。
- `--all`: 非表示のコンポーネントを含むすべてのコンポーネントを表示します。
- `--verbose`: インストールされているバージョンやサポートされているプラットフォームを含むすべての列を表示します。

例1: 現在インストールされているすべてのコンポーネントを表示します。

{{< copyable "shell-regular" >}}

```shell
tiup list --installed
```

例2: サーバーからインストール可能なすべてのTiKVコンポーネントのバージョンのリストを取得します。

{{< copyable "shell-regular" >}}

```shell
tiup list tikv
```

## コンポーネントをインストールする

`tiup install`コマンドを使用してコンポーネントリストを照会できます。このコマンドの使用法は次のとおりです:

- `tiup install <component>`: 指定したコンポーネントの最新安定バージョンをインストールします。
- `tiup install <component>:[version]`: 指定したコンポーネントの指定バージョンをインストールします。

例1: TiUPを使用してTiDBの最新安定バージョンをインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup install tidb
```

例2: TiUPを使用してTiDBのナイトリーバージョンをインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup install tidb:nightly
```

例3: TiUPを使用してTiKV v7.4.0をインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup install tikv:v7.4.0
```

## コンポーネントをアップグレードする

コンポーネントの新しいバージョンが公開された後、`tiup update`コマンドを使用してこのコンポーネントをアップグレードできます。このコマンドの使用法は基本的に`tiup install`と同じですが、以下のフラグを除いています:

- `--all`: すべてのコンポーネントをアップグレードします。
- `--nightly`: ナイトリーバージョンにアップグレードします。
- `--self`: TiUP自体を最新バージョンにアップグレードします。
- `--force`: 最新バージョンに強制的にアップグレードします。

例1: すべてのコンポーネントを最新バージョンにアップグレードします。

{{< copyable "shell-regular" >}}

```shell
tiup update --all
```

例2: すべてのコンポーネントをナイトリーバージョンにアップグレードします。

{{< copyable "shell-regular" >}}

```shell
tiup update --all --nightly
```

例3: TiUPを最新バージョンにアップグレードします。

{{< copyable "shell-regular" >}}

```shell
tiup update --self
```

## コンポーネントを操作する

インストールが完了した後、`tiup <component>`コマンドを使用して対応するコンポーネントを起動できます:

```shell
tiup [flags] <component>[:version] [args...]

Flags:
  -T, --tag string                     コンポーネントインスタンスのタグを指定します。
```

このコマンドを使用するには、コンポーネント名とオプションのバージョンを指定する必要があります。バージョンが指定されていない場合、このコンポーネントの最新安定バージョン（インストール済み）が使用されます。

コンポーネントを起動する前に、TiUPはそれに対してディレクトリを作成し、次にこのディレクトリにコンポーネントを配置します。コンポーネントはこのディレクトリ内のすべてのデータを生成し、このディレクトリの名前はコンポーネントが動作する際に指定されたタグ名です。タグが指定されていない場合は、タグ名がランダムに生成されます。この作業ディレクトリは、インスタンスが終了すると*自動的に削除*されます。

同じコンポーネントを複数回起動し、以前の作業ディレクトリを再利用する場合は、コンポーネントが起動される際に`--tag`を使用して同じ名前を指定できます。タグが指定された後、作業ディレクトリは*自動的に削除されず*、作業ディレクトリを再利用できるようになります。

例1: TiDB v7.4.0を操作します。

{{< copyable "shell-regular" >}}

```shell
tiup tidb:v7.4.0
```

例2: TiKVの操作時にタグを指定します。

{{< copyable "shell-regular" >}}

```shell
tiup --tag=experiment tikv
```

### コンポーネントの動作ステータスを照会する

`tiup status`コマンドを使用してコンポーネントの動作ステータスを確認できます:

{{< copyable "shell-regular" >}}

```shell
tiup status
```

このコマンドを実行することで、1行に1つのインスタンスが含まれるインスタンスのリストが表示されます。このリストには次の列が含まれます:

- `Name`: インスタンスのタグ名。
- `Component`: インスタンスのコンポーネント名。
- `PID`: 実行中のインスタンスのプロセスID。
- `Status`: インスタンスのステータス。 `RUNNING`はインスタンスが動作中であることを示します。 `TERM`はインスタンスが終了していることを示します。
- `Created Time`: インスタンスの起動時間。
- `Directory`: インスタンスの作業ディレクトリ。 `--tag`を使用して指定できます。
- `Binary`: インスタンスの実行可能プログラム。 `--binpath`で指定できます。
- `Args`: インスタンスの操作引数。

### コンポーネントインスタンスをクリーンアップする

`tiup clean`コマンドを使用してコンポーネントインスタンスをクリーンアップし、作業ディレクトリを削除できます。クリーニング前にインスタンスがまだ動作している場合、関連するプロセスが最初に終了されます。コマンドの使用法は次のとおりです:

{{< copyable "shell-regular" >}}

```bash
tiup clean [tag] [flags]
```

このコマンドでは以下のフラグがサポートされています:

- `--all`: すべてのインスタンス情報をクリーンアップします。

上記のコマンドで`tag`はクリーンアップするインスタンスのタグです。`--all`を使用すると、タグを渡す必要はありません。

例1: `experiment`タグ名が付いたコンポーネントインスタンスをクリーンアップします。

{{< copyable "shell-regular" >}}

```shell
tiup clean experiment
```

例2: すべてのコンポーネントインスタンスをクリーンアップします。

{{< copyable "shell-regular" >}}

```shell
tiup clean --all
```

### コンポーネントをアンインストールする

TiUPを使用してインストールされたコンポーネントは、ローカルディスクスペースを使用します。古いバージョンのコンポーネントを多く保持したくない場合は、現在インストールされているコンポーネントのバージョンを確認し、次にこのコンポーネントをアンインストールできます。

`tiup uninstall`コマンドを使用して、すべてのバージョンまたは特定のバージョンのコンポーネントをアンインストールできます。このコマンドはすべてのコンポーネントのアンインストールもサポートしています。コマンドの使用法は次のとおりです:

{{< copyable "shell-regular" >}}

```bash
tiup uninstall [component][:version] [flags]
```

このコマンドでは以下のフラグがサポートされています:

- `--all`: すべてのコンポーネントまたはバージョンをアンインストールします。
- `--self`: TiUP自体をアンインストールします。

`component`はアンインストールするコンポーネントです。`version`はアンインストールするバージョンです。`tiup uninstall`コマンドでは`component`と`version`のどちらかを無視できます。どちらかを無視する場合は`--all`フラグを追加する必要があります。

- バージョンを無視した場合、`--all`を追加するとこのコンポーネントのすべてのバージョンがアンインストールされます。
- バージョンとコンポーネントの両方を無視した場合、`--all`を追加するとすべてのバージョンのすべてのコンポーネントがアンインストールされます。

例1: TiDB v7.4.0をアンインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup uninstall tidb:v7.4.0
```

例2: すべてのTiKVのバージョンをアンインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup uninstall tikv --all
```

例3: インストールされているすべてのコンポーネントをアンインストールします。

{{< copyable "shell-regular" >}}

```shell
tiup uninstall --all
```

### コンポーネントをリンクする
```
TiUP v1.13.0 は実験的な `link` および `unlink` コマンドを追加し、コンポーネントのバイナリを実行ディレクトリ (`$TIUP_HOME/bin/`) にリンクしたり、そのリンクを削除したりすることができます。この機能により、TiUP を介さずにコンポーネントを呼び出すことが可能になり、同時に異なるバージョン間を切り替える能力も保持できます。ただし、この方法には自動アップデートの確認や特定の環境変数の設定が抜けており、一部のコンポーネント (ctl など) を使用できないという点があります。そのため、必要な場合にのみ使用することが推奨されています。

例1: クラスタコンポーネントの最新バージョンをインストールしてリンクする

```shell
tiup install cluster
tiup link cluster
```

例2: クラスタコンポーネントをバージョン v1.13.0 に切り替える

```shell
tiup link cluster:v1.13.0
```

以下は `tiup link cluster` コマンドの出力です:

```shell
package cluster provides these executables: tiup-cluster
```

これは、クラスタコンポーネントのバイナリ名が `tiup-cluster` であることを示しています。リンクコマンドが完了した後、コマンドラインに直接 `tiup-cluster` と入力することで、クラスタコンポーネントを使用できます。

例3: クラスタコンポーネントのリンクを解除する

```shell
tiup unlink cluster
```

例4: TiUP のバージョンを管理する

v1.13.0 より前では、TiUP は `~/.tiup/bin/` にインストールされ、異なるバージョンを共存させることができませんでした。v1.13.0 以降、他のコンポーネントと同様に TiUP をインストールしてリンクすることができます。

```shell
tiup update --self # link をサポートするバージョンに TiUP 自体を更新する
tiup link tiup:v1.13.0
```
```