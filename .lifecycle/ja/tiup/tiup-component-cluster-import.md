---
title: tiup cluster import
---

# tiup cluster import

TiDB v4.0 以前、TiDBクラスターは主にTiDB Ansibleを使用して展開されていました。TiDB v4.0以降のリリースでは、TiUPクラスターは`import`コマンドを提供し、クラスターをtiup-clusterコンポーネントに移行して管理します。

> **注意：**
>
> + TiDB Ansible構成をTiUPにインポートして管理した後は、**TiDB Ansibleを使用してクラスター操作を行わないでください**。さもないと、一貫性のないメタ情報によって競合が発生する可能性があります。
> + TiDB Ansibleを使用して展開されたクラスターが以下の状況のいずれかにある場合、`import`コマンドを使用しないでください。
>     + TLS暗号化が有効なクラスター
>     + 純粋なKVクラスター（TiDBインスタンスのないクラスター）
>     + Kafkaが有効なクラスター
>     + Sparkが有効なクラスター
>     + TiDB Lightning/TiKV Importerが有効なクラスター
>     + 古い`push`モードを使用して監視メトリクスを収集しているクラスター（デフォルトモード`pull`を変更しない場合は、`import`コマンドを使用できます）
>     + `group_vars`ディレクトリで構成されたノンデフォルトポート（`inventory.ini`構成ファイルで`node_exporter_port`/`blackbox_exporter_port`として個別に構成されたポートが互換性がある）を持つクラスター
> + TiDB Ansibleを使用して展開されたクラスターの一部のノードには監視コンポーネントが展開されていない場合、`inventory.ini`ファイルの`monitored_servers`セクションに対応するノード情報を最初に追加し、`deploy.yaml`プレイブックを使用して監視コンポーネントを完全に展開してください。そうしないと、TiUPにクラスターをインポートした後にメンテナンス操作を行うと、監視コンポーネントの不足によりエラーが発生する可能性があります。

## 構文

```shell
tiup cluster import [flags]
```

## オプション

### -d, --dir

- TiDB Ansibleがあるディレクトリを指定します。
- データ型: `STRING`
- このオプションは、現在のディレクトリ（デフォルト値）が渡されますが、デフォルトで有効になっています。

### --ansible-config

- Ansible構成ファイルのパスを指定します。
- データ型: `STRING`
- このオプションは、デフォルト値`. /ansible.cfg`が渡されますが、デフォルトで有効になっています。

### --inventory

- Ansibleインベントリファイルの名前を指定します。
- データ型: `STRING`
- このオプションは、デフォルト値`inventory.ini`が渡されますが、デフォルトで有効になっています。

### --no-backup

- TiDB Ansibleがあるディレクトリのファイルのバックアップを無効にするかどうかを制御します。
- データ型: `BOOLEAN`
- このオプションは、デフォルトで無効になっています（`false`値）。インポートに成功した場合、`-dir`オプションで指定されたディレクトリ内のすべてが`${TIUP_HOME}/.tiup/storage/cluster/clusters/{cluster-name}/ansible-backup`ディレクトリにバックアップされます。このディレクトリに複数のインベントリファイル（複数のクラスターが展開されている場合）がある場合は、このオプションを有効にすることをお勧めします。このオプションを有効にするには、このオプションをコマンドに追加し、`true`値を渡すか、値を渡さないでください。

### --rename

- インポートされたクラスターの名前を変更します。
- データ型: `STRING`
- デフォルト: NULL。このオプションがコマンドで指定されていない場合、インベントリで指定されたcluster_nameがクラスター名として使用されます。

### -h, --help

- ヘルプ情報を出力します。
- データ型: `BOOLEAN`
- このオプションは、デフォルトで無効になっています（`false`値）。このオプションを有効にするには、このオプションをコマンドに追加し、`true`値を渡すか、値を渡さないでください。

## 出力

インポートプロセスのログを表示します。

[<< 前のページに戻る - TiUP Clusterコマンドリスト](/tiup/tiup-component-cluster.md#command-list)