---
title: 組織SSO認証
summary: カスタム組織認証を使用してTiDB Cloudコンソールにログインする方法について学びます。

# 組織SSO認証

単一サインオン（SSO）は、あなたのTiDB Cloudの[組織](/tidb-cloud/tidb-cloud-glossary.md#organization)のメンバーが、電子メールアドレスとパスワードの代わりに、IDプロバイダー（IdP）のアイデンティティを使用してTiDB Cloudにログインできるようにする認証方式です。

TiDB Cloudは、次の2種類のSSO認証をサポートしています。

- [基本SSO](/tidb-cloud/tidb-cloud-sso-authentication.md)：メンバーは、GitHub、Google、またはMicrosoftの認証方法を使用して[TiDB Cloudコンソール](https://tidbcloud.com/)にログインできます。基本SSOは、TiDB Cloudのすべての組織にデフォルトで有効です。

- クラウド組織SSO：メンバーは組織が指定した認証方法を使用してTiDB Cloudのカスタムログインページにログインできます。クラウド組織SSOは、デフォルトでは無効です。

基本SSOと比べ、クラウド組織SSOは、組織のセキュリティおよび準拠要件により適した柔軟性とカスタマイズを提供します。たとえば、ログインページに表示される認証方法を指定したり、ログインに許可される電子メールアドレスのドメインを制限したり、組織のメンバーが[OpenID Connect（OIDC）](https://openid.net/connect/)または[Security Assertion Markup Language（SAML）](https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language)アイデンティティプロトコルを使用するIDプロバイダーを使用してTiDB Cloudにログインすることができます。

このドキュメントでは、組織の認証方式を基本SSOからクラウド組織SSOに移行する方法について説明します。

> **注記:**
>
> - クラウド組織SSO機能はベータ版であり、リクエストによってのみ利用可能です。この機能をリクエストするには、[TiDB Cloud コンソール](https://tidbcloud.com)の右下にある **?** をクリックし、**サポートをリクエスト** をクリックしてください。次に、**説明**フィールドに「クラウド組織SSOの申請」を記入して **送信** をクリックしてください。
> - もし現在のTiDBログインURLが`https://tidbcloud.com/enterprise/`で始まる場合、クラウド組織SSOが組織で既に有効になっていることを意味します。

## 開始前の確認

クラウド組織SSOに移行する前に、組織の以下の項目をチェックし、確認してください。

> **注記:**
>
> - クラウド組織SSOが有効になると、無効にすることはできません。
> - クラウド組織SSOを有効にするには、TiDB Cloud組織の`組織所有者`ロールである必要があります。ロールに関する詳細情報については、[ユーザーのロール](/tidb-cloud/manage-user-access.md#user-roles)を参照してください。

### TiDB CloudログインページのカスタムURLを決定する

クラウド組織SSOが有効になると、メンバーはTiDB Cloudにログインするために、パブリックログインURL（`https://tidbcloud.com`）の代わりに、カスタムURLを使用する必要があります。

カスタムURLは有効化後に変更できないため、あらかじめ使用するURLを決定する必要があります。

カスタムURLのフォーマットは `https://tidbcloud.com/enterprise/signin/your-company-name` であり、会社名をカスタマイズできます。

### 組織メンバーの認証方法を決定する

TiDB Cloudでは、組織SSO用に以下の認証方法を提供しています。

- Google
- GitHub
- Microsoft
- OIDC
- SAML

クラウド組織SSOを有効にすると、最初の3つの方法がデフォルトで有効になります。

有効になっているすべての認証方法がカスタムTiDB Cloudログインページに表示されるため、あらかじめ有効または無効にする認証方法を決定する必要があります。

### 自動プロビジョニングの有効化を決定する

自動プロビジョニングは、`組織所有者`または`プロジェクト所有者`からの招待を必要とせずに、メンバーが自動的に組織に参加できる機能です。TiDB Cloudでは、この機能はデフォルトで無効になっています。

- メール送信のためのポートを確認することをお勧めします。 

セキュリティを考慮して自動プロビジョニングを有効にする場合、認証に使用する許可された電子メールドメインを制限することをお勧めします。 

自動プロビジョニングが無効になっている場合、`組織所有者`または`プロジェクト所有者`によって招待されたユーザーのみがカスタムURLにログインできます。 

自動プロビジョニングが有効になっている場合、この認証方法を使用するユーザーはいずれもカスタムURLにログインできます。ログイン後、それらのユーザーは組織内のデフォルトの**メンバー**ロールが自動的に割り当てられます。

クラウド組織SSOを有効にする前に、以下について組織メンバーに通知することを忘れないでください。

- TiDB CloudのカスタムログインURL
- `https://tidbcloud.com`の代わりにカスタムログインURLを使用する開始時刻
- 利用可能な認証方法
- メンバーがカスタムURLにログインするための招待が必要かどうか

## Step 1. クラウド組織SSOの有効化

クラウド組織SSOを有効にするには、次の手順を実行してください。

1. `組織所有者`ロールを持つユーザーとして[TiDB Cloudコンソール](https://tidbcloud.com)にログインします。
2. TiDB Cloudコンソールの左下隅にある <MDSvgIcon name="icon-top-organization" /> をクリックし、**組織の設定**をクリックします。
3. **組織設定** ページで、**認証** タブをクリックし、**有効化**をクリックします。
4. ダイアログボックスで、TiDB Cloudの中で一意である必要があるカスタムURLを組織に入力します。

    > **注記:**
    >
    > クラウド組織SSOが有効になると、あなたの組織のメンバーはあなたのカスタムURLを使用してTiDB Cloudにログインすることができます。構成済のURLを後で変更する必要がある場合は、[TiDB Cloudサポート](/tidb-cloud/tidb-cloud-support.md)に連絡してサポートを依頼してください。

5. **理解して確認する**のチェックボックスをクリックし、**有効化**をクリックします。

    > **注記:**
    >
    > もしダイアログボックスにクラウド組織SSOのために再招待および再参加するユーザー一覧が含まれている場合、TiDB Cloudはクラウド組織SSOを有効にした後、これらのユーザーに招待メールを自動的に送信します。招待メールを受信したユーザーは、メール内のリンクをクリックして自分のアイデンティティを確認し、カスタムログインページが表示されます。

## Step 2. 認証方法の構成

TiDB Cloudでの認証方法の有効化により、その方法を使用しているメンバーがカスタムURLを使用してTiDB Cloudにログインできるようになります。

### Google、GitHub、またはMicrosoftの認証方法の構成

クラウド組織SSOが有効になった後、Google、GitHub、およびMicrosoftの認証方法を以下に従って構成できます。

1. **組織設定**ページで、Google、GitHub、またはMicrosoftの認証方法を必要に応じて有効または無効にします。
2. 有効な認証方法に対して、その方法の詳細を構成するには、<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 20H21M3.00003 20H4.67457C5.16376 20 5.40835 20 5.63852 19.9447C5.84259 19.8957 6.03768 19.8149 6.21663 19.7053C6.41846 19.5816 6.59141 19.4086 6.93732 19.0627L19.5001 6.49998C20.3285 5.67156 20.3285 4.32841 19.5001 3.49998C18.6716 2.67156 17.3285 2.67156 16.5001 3.49998L3.93729 16.0627C3.59139 16.4086 3.41843 16.5816 3.29475 16.7834C3.18509 16.9624 3.10428 17.1574 3.05529 17.3615C3.00003 17.5917 3.00003 17.8363 3.00003 18.3255V20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> をクリックします。
3. 方法の詳細を構成できます。具体的には以下を構成できます。

    - [**アカウントの自動プロビジョニング**](#自動プロビジョニングの有効化を決定する)

        これは初期状態では無効になっています。必要に応じて有効化することができます。 セキュリティを考慮して自動プロビジョニングを有効にする場合、認証に使用する許可された電子メールドメインを制限することをお勧めします。

    - **許可された電子メールドメイン**

        このフィールドを設定すると、この認証方法の指定された電子メールドメインのみがカスタムURLを使用してTiDB Cloudにログインできます。 ドメイン名を入力する際は、`@`記号を除外し、コンマで区切ってください。 たとえば、`company1.com,company2.com`。

        > **注記:**
        >
        > ログインに使用している電子メールドメインを追加することを忘れずに、設定を保存する前に、これらのドメインを追加してください。そうしないと、TiDB Cloudからロックされる可能性があります。

4. **保存**をクリックします。

### OIDC 認証メソッドの構成

OIDC 識別プロトコルを使用するアイデンティティプロバイダーがある場合、TiDB Cloud ログインのためにOIDC認証メソッドを有効にできます。

TiDB Cloud では、OIDC認証メソッドはデフォルトで無効になっています。Cloud組織Cloudを有効にした後、次のようにOIDC認証メソッドを有効にして構成できます。

1. TiDB Cloud組織SSOのためにアイデンティティプロバイダーから次の情報を取得します。

    - 発行者 URL
    - クライアントID
    - クライアントシークレット

2. **組織設定** ページで、**認証** タブをクリックし、**認証メソッド** 領域のOIDCの行を見つけ、OIDCメソッドの詳細を表示するために <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 20H21M3.00003 20H4.67457C5.16376 20 5.40835 20 5.63852 19.9447C5.84259 19.8957 6.03768 19.8149 6.21663 19.7053C6.41846 19.5816 6.59141 19.4086 6.93732 19.0627L19.5001 6.49998C20.3285 5.67156 20.3285 4.32841 19.5001 3.49998C18.6716 2.67156 17.3285 2.67156 16.5001 3.49998L3.93729 16.0627C3.59139 16.4086 3.41843 16.5816 3.29475 16.7834C3.18509 16.9624 3.10428 17.1574 3.05529 17.3615C3.00003 17.5917 3.00003 17.8363 3.00003 18.3255V20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> をクリックします。
3. メソッドの詳細で、以下を構成できます。

    - **名前**

        カスタムログインページに表示されるOIDC認証メソッドの名前を指定します。

    - **発行者 URL**、**クライアントID**、および **クライアントシークレット**

        IdPから取得した対応する値を貼り付けます。

    - [**アカウントの自動プロビジョニング**](#アカウントの自動プロビジョニングを有効にするかどうかを決定)

        デフォルトでは無効です。 必要に応じて有効にできます。 セキュリティ上の考慮事項として、自動プロビジョニングを有効にする場合、認証のために許可される電子メールドメインを制限することをお勧めします。

    - **許可されたメールドメイン**

        この認証メソッドの指定されたメールドメインのみが、カスタムURLを使用してTiDB Cloudにログインできます。 ドメイン名を記入する際は、 `@` 記号を除外し、コンマで区切ってください。 例えば、 `company1.com,company2.com`。

        > **注意:**
        >
        > メールドメインを構成した場合は、設定を保存する前に、現在のログインに使用しているメールドメインを追加して、TiDB Cloudによるロックアウトを避けるようにしてください。

4. **保存** をクリックします。

### SAML 認証メソッドの構成

SAML識別プロトコルを使用するアイデンティティプロバイダーがある場合、TiDB Cloud ログインのためにSAML認証メソッドを有効にできます。

TiDB Cloud では、SAML認証メソッドはデフォルトで無効になっています。Cloud組織Cloudを有効にした後、次のようにSAML認証メソッドを有効にして構成できます。

1. TiDB Cloud組織SSOのためにアイデンティティプロバイダーから次の情報を取得します。

    - サインオンURL
    - サインイン証明書

2. **組織設定** ページで、**認証** タブをクリックし、**認証メソッド** 領域のSAMLの行を見つけ、SAMLメソッドの詳細を表示するために <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 20H21M3.00003 20H4.67457C5.16376 20 5.40835 20 5.63852 19.9447C5.84259 19.8957 6.03768 19.8149 6.21663 19.7053C6.41846 19.5816 6.59141 19.4086 6.93732 19.0627L19.5001 6.49998C20.3285 5.67156 20.3285 4.32841 19.5001 3.49998C18.6716 2.67156 17.3285 2.67156 16.5001 3.49998L3.93729 16.0627C3.59139 16.4086 3.41843 16.5816 3.29475 16.7834C3.18509 16.9624 3.10428 17.1574 3.05529 17.3615C3.00003 17.5917 3.00003 17.8363 3.00003 18.3255V20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> をクリックします。
3. メソッドの詳細で、以下を構成できます。

    - **名前**

        カスタムログインページに表示されるSAML認証メソッドの名前を指定します。

    - **サインオンURL**

        IdPから取得したURLを貼り付けます。

    - **サインイン証明書**

        IdPからの署名証明書全体を貼り付けます。開始行 `---begin certificate---` と終了行 `---end certificate---` を含めてください。

    - [**アカウントの自動プロビジョニング**](#アカウントの自動プロビジョニングを有効にするかどうかを決定)

        デフォルトでは無効です。 必要に応じて有効にできます。 セキュリティ上の考慮事項として、自動プロビジョニングを有効にする場合、認証のために許可される電子メールドメインを制限することをお勧めします。

    - **許可されたメールドメイン**

        この認証メソッドの指定されたメールドメインのみが、カスタムURLを使用してTiDB Cloudにログインできます。 ドメイン名を記入する際は、 `@` 記号を除外し、コンマで区切ってください。 例えば、 `company1.com,company2.com`。

        > **注意:**
        >
        > メールドメインを構成した場合は、設定を保存する前に、現在のログインに使用しているメールドメインを追加して、TiDB Cloudによるロックアウトを避けるようにしてください。

4. **保存** をクリックします。