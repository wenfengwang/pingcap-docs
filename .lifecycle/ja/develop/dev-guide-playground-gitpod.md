---
title: Gitpod
---

<!-- markdownlint-disable MD029 -->

# Gitpod

[Gitpod](https://www.gitpod.io/)を使用すると、ボタンまたはリンクをクリックするだけでブラウザで完全な開発環境を取得し、すぐにコードを書くことができます。

Gitpodは、クラウド上でタスクごとに新しい自動生成の開発環境を瞬時に構築する[オープンソースのKubernetesアプリケーション](https://github.com/gitpod-io/gitpod)であり、開発環境をコードとして記述し、ブラウザまたはデスクトップのIDEから直接リモートおよびクラウドベースの開発環境を瞬時に起動できます。

## クイックスタート

1. TiDBアプリケーションの開発用に、例となるコードリポジトリ[pingcap-inc/tidb-example-java](https://github.com/pingcap-inc/tidb-example-java)をフォークします。

2. サンプルコードリポジトリのURLに`https://gitpod.io/#`を付けて、ブラウザのアドレスバーに入力してGitpodワークスペースを開始します。

   - たとえば、`https://gitpod.io/#https://github.com/pingcap-inc/tidb-example-java`。

   - URLに環境変数を設定できます。たとえば、`https://gitpod.io/#targetFile=spring-jpa-hibernate_Makefile,targetMode=spring-jpa-hibernate/https://github.com/pingcap-inc/tidb-example-java`。

3. ログインして、リストされたプロバイダの中からワークスペースを開始します。たとえば、`Github`。

## デフォルトのGitpod構成と環境の使用

[クイックスタート](#quick-start)の手順を完了すると、Gitpodはワークスペースの設定を行います。

Spring Boot Webアプリケーションを例に挙げます。`https://gitpod.io/#targetFile=spring-jpa-hibernate_Makefile,targetMode=spring-jpa-hibernate/https://github.com/pingcap-inc/tidb-example-java` URLで新しいワークスペースを作成できます。

その後、次のようなページが表示されます。

![playground gitpod workspace init](/media/develop/playground-gitpod-workspace-init.png)

このページのシナリオでは、[TiUP](https://docs.pingcap.com/zh/tidb/stable/tiup-overview)を使用してTiDB Playgroundを構築しています。ターミナルエリアの左側で進捗状況をチェックできます。

TiDB Playgroundの準備が整ったら、さらに`Spring JPA Hibernate`タスクが実行されます。ターミナルエリアの右側で進捗状況をチェックできます。

これらのタスクがすべて完了すると、次のようなページが表示されます。このページで、左のナビゲーションペインの`REMOTE EXPLORER`エリアをチェックし（GitpodはURLベースのポート転送をサポートしています）、ポート`8080`のURLを見つけます。

![playground gitpod workspace ready](/media/develop/playground-gitpod-workspace-ready.png)

## カスタムのGitpod構成とDockerイメージの使用

### Gitpodの構成のカスタマイズ

[example.gitpod.yml](https://github.com/pingcap-inc/tidb-example-java/blob/main/.gitpod.yml)を参照して、プロジェクトのルートディレクトリに`.gitpod.yml`ファイルを作成し、Gitpodワークスペースを構成します。

```yml
# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

# image:
#   file: .gitpod.Dockerfile

tasks:
  - name: Open Target File
    command: |
      if [ -n "$targetFile" ]; then code ${targetFile//[_]//};  fi
  - name: TiUP init playground
    command: |
      $HOME/.tiup/bin/tiup playground
  - name: Test Case
    openMode: split-right
    init: echo "*** Waiting for TiUP Playground Ready! ***"
    command: |
      gp await-port 3930
      if [ "$targetMode" == "plain-java-jdbc" ]
      then
        cd plain-java-jdbc
        code src/main/resources/dbinit.sql
        code src/main/java/com/pingcap/JDBCExample.java
        make mysql
      elif [ "$targetMode" == "plain-java-hibernate" ]
      then
        cd plain-java-hibernate
        make
      elif [ "$targetMode" == "spring-jpa-hibernate" ]
      then
        cd spring-jpa-hibernate
        make
      fi
ports:
  - port: 8080
    visibility: public
  - port: 4000
    visibility: public
  - port: 2379-36663
    onOpen: ignore
```

### カスタムのGitpod Dockerイメージの使用

デフォルトでは、GitpodはWorkspace-Fullという標準のDockerイメージを使用してワークスペースを起動します。このデフォルトイメージから起動されたワークスペースには、Docker、Go、Java、Node.js、C/C++、Python、Ruby、Rust、PHPなどの予めインストールされたものと、Homebrew、Tailscale、Nginxなどのツールが含まれています。

必要なプロジェクトの依存関係をインストールした公開DockerイメージまたはDockerfileを使用することができます。

例えば、次のようにDockerfile（[Example `.gitpod.Dockerfile`](https://github.com/pingcap-inc/tidb-example-java/blob/main/.gitpod.Dockerfile)を参照）を使用できます。

```dockerfile
FROM gitpod/workspace-java-17

RUN sudo apt install mysql-client -y
RUN curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh
```

その後、`.gitpod.yml`を更新する必要があります。

```yml
# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

image:
  # Dockerfileをここにインポートします。
  file: .gitpod.Dockerfile

tasks:
  - name: Open Target File
    command: |
      if [ -n "$targetFile" ]; then code ${targetFile//[_]//};  fi
  - name: TiUP init playground
    command: |
      $HOME/.tiup/bin/tiup playground
  - name: Test Case
    openMode: split-right
    init: echo "*** Waiting for TiUP Playground Ready! ***"
    command: |
      gp await-port 3930
      if [ "$targetMode" == "plain-java-jdbc" ]
      then
        cd plain-java-jdbc
        code src/main/resources/dbinit.sql
        code src/main/java/com/pingcap/JDBCExample.java
        make mysql
      elif [ "$targetMode" == "plain-java-hibernate" ]
      then
        cd plain-java-hibernate
        make
      elif ["$targetMode" == "spring-jpa-hibernate" ]
      then
        cd spring-jpa-hibernate
        make
      fi
ports:
  - port: 8080
    visibility: public
  - port: 4000
    visibility: public
  - port: 2379-36663
    onOpen: ignore
```

### 変更の適用

`.gitpod.yml`ファイルの設定を完了したら、最新のコードが対応するGitHubリポジトリにあることを確認します。

`https://gitpod.io/#<YOUR_REPO_URL>`を訪れて、適用された最新のコードで新しいGitpodワークスペースを作成します。

すべての確立済みのワークスペースについては、`https://gitpod.io/workspaces`を訪れます。

## 概要

Gitpodは完全かつ自動化されたクラウドネイティブの開発環境を提供します。ローカルの構成なしにブラウザで直接コードの開発、実行、テストを行うことができます。

![playground gitpod summary](/media/develop/playground-gitpod-summary.png)