---
title: キーメトリクス
summary: Grafanaの概要ダッシュボードに表示される主要なメトリクスについて学びます。
aliases: ['/docs/dev/grafana-overview-dashboard/','/docs/dev/reference/key-monitoring-metrics/overview-dashboard/']
---

# キーメトリクス

TiUPを使用してTiDBクラスタを展開する場合、モニタリングシステム（Prometheus & Grafana）は同時に展開されます。詳細については[TiDBモニタリングフレームワークの概要](/tidb-monitoring-framework.md)を参照してください。

Grafanaダッシュボードは、概要、PD、TiDB、TiKV、Node_exporter、Disk Performance、Performance_overviewなどの一連のサブダッシュボードに分かれており、診断に役立つ多くのメトリクスがあります。

日常の操作では、主要なメトリクスが表示されている概要ダッシュボードから各コンポーネント（PD、TiDB、TiKV）の状態とクラスタ全体の概要を把握できます。このドキュメントでは、これらの主要なメトリクスについて詳細に説明します。

## キーメトリクスの説明

概要ダッシュボードに表示される主要なメトリクスを理解するには、次の表を確認してください。

| サービス | パネル名 | 説明 | 通常範囲 |
| ---- | ---------------- | ---------------------------------- | -------------- |
| サービスポートステータス | サービスの稼働 | 各サービスのオンラインノード数。 |
| PD | PDの役割 | 現在のPDの役割。 |
| PD | ストレージ容量 | TiDBクラスタの合計ストレージ容量。 |
| PD | 現在のストレージサイズ | TiDBクラスタの使用されているストレージ容量（TiKVレプリカによって占有されるスペースを含む）。 |
| PD | 通常のストア | 通常の状態のノード数。 |
| PD | 異常なストア | 異常な状態のノード数。 | 0 |
| PD | リージョンの数 | 現在のクラスタの全リージョン数。なお、リージョン数はレプリカ数とは関係ありません。 |
| PD | 完了コマンドの99%の所要時間（秒単位） | pd-serverリクエストを完了するための所要時間の99パーセンタイル。 | 5ms未満
| PD | ハンドルリクエストの所要時間（秒単位） | PDリクエストのネットワーク所要時間。 |
| PD | リージョンの健康状態 | 各リージョンの状態。 | 通常、保留中のピア数は100未満であり、不足しているピア数は常に`0`より大きい場合がある。 |
| PD | ホットライトリージョンのリーダー分布 | 各TiKVインスタンスのライトホットスポットであるリーダーの合計数。 |
| PD | ホットリードリージョンのリーダー分布 | 各TiKVインスタンスのリードホットスポットであるリーダーの合計数。 |
| PD | リージョンハートビートレポート | PDに報告される各インスタンスのハートビートの回数。 |
| PD | リージョンハートビートの99%遅延 | TiKVインスタンスごとのハートビート遅延（P99）。 |
| TiDB | ステートメントOPS | 実行された異なる種類のSQLステートメントの数（秒単位）。`SELECT`、`INSERT`、`UPDATE`などのステートメントごとに数えられます。 |
| TiDB | 所要時間 | 実行時間。<br/>1. クライアントのネットワークリクエストがTiDBに送信され、TiDBがリクエストを実行した後にクライアントに返されるまでの経過時間。一般的に、クライアントリクエストはSQLステートメントの形で送信されます。しかし、この所要時間には、`COM_PING`、`COM_SLEEP`、`COM_STMT_FETCH`、`COM_SEND_LONG_DATA`などのコマンドの実行時間も含まれます。<br/>2. TiDBはMulti-Queryをサポートしているため、TiDBは`select 1; select 1; select 1;`のように一度に複数のSQLステートメントを送信することをサポートしています。この場合、このクエリの合計実行時間には、すべてのSQLステートメントの実行時間が含まれます。 |
| TiDB | インスタンスごとのCPS | インスタンスごとのコマンド統計、実行結果の成功または失敗によって分類されます。 |
| TiDB | 失敗したクエリOPM | 各TiDBインスタンスで実行されたSQLステートメントの実行時に発生したエラータイプ（構文エラーやプライマリキーコンフリクトなど）の統計。エラーが発生したモジュールとエラーコードが含まれます。 |
| TiDB | 接続数 | 各TiDBインスタンスの接続数。 |
| TiDB | メモリ使用量 | 各TiDBインスタンスのメモリ使用量の統計。プロセスによって占有されるメモリとGolangのヒープに適用されるメモリに分かれます。 |
| TiDB | トランザクションOPS | 秒単位で実行されたトランザクションの数。 |
| TiDB | トランザクションの所要時間 | トランザクションの実行時間 |
| TiDB | KVコマンドOPS | 実行されたKVコマンドの数。 |
| TiDB | KVコマンドの所要時間99 | KVコマンドの所要時間。 |
| TiDB | PD TSO OPS | TiDBがPDから獲得するTSOの数（秒単位）。 |
| TiDB | PD TSOの待機時間 | TiDBがPDからTSOを返すまでの待機時間。 |
| TiDB | TiClientリージョンエラーOPS | TiKVから返されるリージョン関連のエラーの数。 |
| TiDB | ロック解決OPS | ロックを解決するTiDB操作の数。TiDBの読み取りまたは書き込みリクエストがロックに遭遇した場合、ロックを解決しようとします。 |
| TiDB | KVバックオフOPS | TiKVから返されるエラーの数。 |
| TiKV | リーダー | 各TiKVノードのリーダーの数。 |
| TiKV | リージョン | 各TiKVノードのリージョンの数。 |
| TiKV | CPU | 各TiKVノードのCPU使用率。 |
| TiKV | メモリ | 各TiKVノードのメモリ使用量。 |
| TiKV | ストアサイズ | 各TiKVインスタンスが使用するストレージスペースのサイズ。 |
| TiKV | CFサイズ | 各カラムファミリー（CF）のサイズ。 |
| TiKV | チャネルフル | 各TiKVインスタンスでの「チャネルフル」エラーの数。 | 0 |
| TiKV | サーバーレポートの失敗 | 各TiKVインスタンスが報告したエラーメッセージの数。 | 0 |
| TiKV | スケジューラの保留中コマンド | 各TiKVインスタンスでの保留中のコマンドの数。 |
| TiKV | Coprocessor実行回数 | 秒単位でTiKVが受信したCoprocessor操作の数。各種類のCoprocessorが個別に数えられます。 |
| TiKV | Coprocessorリクエストの所要時間 | Coprocessorの読み取りリクエストを処理するためにかかる時間。 |
| TiKV | raftstoreスレッドのCPU | raftstoreスレッドのCPU使用率 | デフォルトのスレッド数は2（`raftstore.store-pool-size`で構成されます）。1つのスレッドの80%を超える値は、CPU使用率が非常に高いことを示します。|
| TiKV | Coprocessor CPU | CoprocessorスレッドのCPU使用率。 |
| システム情報 | 仮想コア数 | CPUコア数。 |
| システム情報 | メモリ | 合計メモリ。 |
| システム情報 | CPU使用率 | CPU使用率、最大100%。 |
| システム情報 | 負荷 [1m] | 1分以内の過負荷。 |
| システム情報 | 利用可能なメモリ | 利用可能なメモリのサイズ。 |
| システム情報 | ネットワークトラフィック | ネットワークトラフィックの統計。 |
| システム情報 | TCP再送 | TOCの再送回数。 |
| システム情報 | IO利用率 | ディスク使用率、最大100%。通常、使用率が80%〜90%に達した場合、新しいノードの追加を検討する必要があります。 |

## 概要ダッシュボードのインターフェース

![overview](/media/grafana-monitor-overview.png)