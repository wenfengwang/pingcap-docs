---
title: 誤ったインデックスの解決策
summary: 誤ったインデックスの問題を解決する方法を学びます。

# 誤ったインデックスの解決策

クエリの実行速度が期待に達しないことがわかった場合、オプティマイザはクエリを実行するために誤ったインデックスを選択した可能性があります。

まず、統計情報の[テーブルのヘルスステート](/statistics.md#health-state-of-tables)を表示して、異なるヘルスステートに応じて問題を解決できます。

## 低いヘルスステート

低いヘルスステートとは、TiDBが長い間`ANALYZE`ステートメントを実行していないことを意味します。 `ANALYZE`コマンドを実行して統計情報を更新できます。更新後、オプティマイザが依然として誤ったインデックスを使用している場合は、次のセクションを参照してください。

## ほぼ100%のヘルスステート

ほぼ100%のヘルスステートは、`ANALYZE`ステートメントがちょうど完了したか、ごく最近完了したことを示します。この場合、誤ったインデックスの問題は、行の数に対するTiDBの推定ロジックに関連している可能性があります。

等価クエリの場合、原因は[Count-Min Sketch](/statistics.md#count-min-sketch)である可能性があります。Count-Min Sketchが原因であるかどうかを確認し、対応する解決策を取ることができます。

上記の原因が問題に当てはまらない場合は、`USE_INDEX`または`use index`オプティマイザヒント（詳細は[USE_INDEX](/optimizer-hints.md#use_indext1_name-idx1_name--idx2_name-)を参照）を使用してインデックスを強制的に選択することができます。また、[SQLプラン管理](/sql-plan-management.md)を使用してクエリの動作を非侵襲的に変更することもできます。

## その他の状況

上記の状況のほかにも、誤ったインデックスの問題は、すべてのインデックスがもはや適用されなくなるようなデータ更新によっても引き起こされる可能性があります。このような場合は、条件やデータの分布の分析を行い、新しいインデックスがクエリの処理速度を向上させるかどうかを確認する必要があります。その場合、[`ADD INDEX`](/sql-statements/sql-statement-add-index.md)コマンドを実行して新しいインデックスを追加することができます。
