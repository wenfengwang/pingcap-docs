---
title: 構成オプション
summary: TiDBの構成オプションを学ぶ。
aliases: ['/docs/dev/command-line-flags-for-tidb-configuration/','/docs/dev/reference/configuration/tidb-server/configuration/','/docs/dev/reference/configuration/tidb-server/server-command-option/']
---

# 構成オプション

TiDBクラスタを起動する際、コマンドラインオプションや環境変数を使用して構成を行うことができます。本文書ではTiDBのコマンドオプションを紹介します。デフォルトのTiDBポートは、クライアントリクエスト用に`4000`、ステータスレポート用に`10080`です。

## `--advertise-address`

- TiDBサーバにログインするためのIPアドレス
- デフォルト: `""`
- このアドレスはTiDBクラスタとユーザからアクセス可能である必要があります。

## `--config`

- 設定ファイル
- デフォルト: `""`
- 設定ファイルを指定した場合、TiDBはその設定ファイルを読み込みます。対応する設定がコマンドラインオプションでも存在する場合、TiDBはコマンドラインオプションの設定で上書きします。詳細な設定情報については、[TiDB設定ファイルの説明](/tidb-configuration-file.md)を参照してください。

## `--config-check`

- 設定ファイルの妥当性をチェックし、終了します
- デフォルト: `false`

## `--config-strict`

- 設定ファイルの妥当性を強制します
- デフォルト: `false`

## `--cors`

- TiDB HTTPステータスサービスのCross-Origin Request Sharing（CORS）リクエスト用の`Access-Control-Allow-Origin`の値を指定します
- デフォルト: `""`

## `--enable-binlog`

+ TiDB binlogの生成を有効または無効にします
+ デフォルト: `false`

## `--host`

- TiDBサーバが監視するホストアドレス
- デフォルト: `"0.0.0.0"`
- TiDBサーバはこのアドレスを監視します。
- `"0.0.0.0"`アドレスはデフォルトですべてのネットワークカードを監視します。複数のネットワークカードがある場合は、`192.168.100.113`など、サービスを提供するネットワークカードを指定してください。

## `--initialize-insecure`

- tidb-serverを不安全モードで起動します
- デフォルト: `true`

## `--initialize-secure`

- tidb-serverをセキュアモードで起動します
- デフォルト: `false`

## `--initialize-sql-file`

- TiDBクラスタを初めて起動する際に実行されるSQLスクリプト
- 詳細については、[設定項目`initialize-sql-file`](/tidb-configuration-file.md#initialize-sql-file-new-in-v660)を参照してください
- デフォルト: `""`

## `-L`

- ログレベル
- デフォルト: `"info"`
- オプションの値: `"debug"`、`"info"`、`"warn"`、`"error"`、`"fatal"`

## `--lease`

- スキーマリースの期間。
- この値を変更するのは**危険**です。自分が何をしているかよくわかっている場合を除き、デフォルトの値を使用してください。
- デフォルト: `45s`

## `--log-file`

- ログファイル
- デフォルト: `""`
- このオプションを設定しない場合、ログは「stderr」に出力されます。このオプションを設定すると、対応するファイルにログが出力されます。

## `--log-slow-query`

- 遅いクエリログのディレクトリ
- デフォルト: `""`
- このオプションを設定しない場合、デフォルトでは`--log-file`で指定されたファイルにログが出力されます。

## `--metrics-addr`

- Prometheus Pushgatewayアドレス
- 空にするとPrometheusクライアントのプッシュが停止します
- フォーマットは`--metrics-addr=192.168.100.115:9091`です

## `--metrics-interval`

- Prometheusクライアントのプッシュインターバル（秒単位）
- デフォルト: `15s`
- この値を0に設定すると、Prometheusクライアントのプッシュが停止します

## `-P`

- TiDBサービスのモニタリングポート
- デフォルト: `"4000"`
- TiDBサーバはこのポートからMySQLクライアントのリクエストを受け付けます

## `--path`

- "unistore"などのローカルストレージエンジンのデータディレクトリへのパス
- `--store = tikv`の場合、パスを指定する必要があります。`--store = unistore`の場合、パスを指定しないとデフォルト値が使用されます。
- TiKVなどの分散ストレージエンジンの場合、`--path`は実際のPDアドレスを指定します。PDサーバーを`192.168.100.113:2379`、`192.168.100.114:2379`、`192.168.100.115:2379`に展開したと仮定すると、`--path`の値は`"192.168.100.113:2379, 192.168.100.114:2379, 192.168.100.115:2379"`です。
- デフォルト: `"/tmp/tidb"`
- 純粋なメモリ内TiDBを有効にするには、`tidb-server --store=unistore --path=""`を使用できます。

## `--proxy-protocol-fallbackable`

- PROXYプロトコルフォールバックモードを有効にするかどうかを制御します。このパラメータを`true`に設定すると、TiDBはPROXYプロトコル仕様を使用しないか、PROXYプロトコルヘッダーを送信しない場合でも、`--proxy-protocol-networks`に属するクライアント接続を受け入れます。デフォルトでは、TiDBは`--proxy-protocol-networks`に属し、PROXYプロトコルヘッダーを送信するクライアント接続のみを受け入れます。
- デフォルト値: `false`

## `--proxy-protocol-networks`

- TiDBに接続するのを許可するプロキシサーバーのIPアドレスのリスト。[PROXYプロトコル](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt)を使用して接続するプロキシサーバーのIPアドレスのリストです。
- デフォルト: `""`
- 一般的な場合、リバースプロキシの背後でTiDBにアクセスする際、TiDBはリバースプロキシサーバーのIPアドレスをクライアントのIPアドレスとして取ります。PROXYプロトコルを有効にすることで、このようなプロトコルをサポートするHAProxyなどのリバースプロキシは実際のクライアントIPアドレスをTiDBに渡すことができます。
- このフラグを設定した後、TiDBは指定されたソースIPアドレスからPROXYプロトコルを使用してTiDBに接続を許可し、PROXY以外のプロトコルを使用すると接続が拒否されます。このフラグが空の場合、IPアドレスはPROXYプロトコルを使用してTiDBに接続することができません。値はIPアドレス（192.168.1.50）またはCIDR（192.168.1.0/24）で、セパレーターに`,`を使用します。`*`は任意のIPアドレスを意味します。

> **警告:**
>
> `*`を使用する場合は注意してください。任意のIPアドレスのクライアントが自分のIPアドレスを報告するセキュリティリスクを招く可能性があります。さらに、`*`を使用すると、TiDBに直接接続する内部コンポーネント（TiDBダッシュボードなど）が`--proxy-protocol-fallbackable`を`true`に設定しない限り使用できなくなる可能性もあります。

> **注意:**
>
> PROXYプロトコルを有効にしてAWSネットワークロードバランサー（NLB）を使用するには、NLBの`target group`プロパティを構成する必要があります。具体的には`proxy_protocol_v2.client_to_server.header_place`を`on_first_ack`に設定します。同時にAWSサポートへチケットを提出する必要があります。PROXYプロトコルを有効にした後、クライアントはサーバからハンドシェイクパケットを取得できなくなり、パケットはクライアントがタイムアウトするまでブロックされます。これは、NLBがクライアントがデータを送信するとPROXYパケットを送信するためです。ただし、クライアントがデータパケットを送信する前にサーバから送信されたデータパケットが内部ネットワークで破棄されます。

## `--proxy-protocol-header-timeout`

- PROXYプロトコルヘッダーの読み込みタイムアウト
- デフォルト: `5`（秒）

> **警告:**
>
> v6.3.0以降、このパラメータは非推奨です。ネットワークデータを読み取る際にPROXYプロトコルヘッダーが最初に読み込まれるため、このパラメータは使用されません。このパラメータの非推奨化により、最初にネットワークデータを読み取る際に設定されたタイムアウトが影響を受けることは避けられます。

> **注意:**
>
> この値を`0`に設定しないでください。特別な状況を除き、デフォルト値を使用してください。

## `--report-status`

- ステータスレポートとpprofツールを有効（`true`）または無効（`false`）にします
- デフォルト: `true`
- `true`に設定すると、このパラメータはメトリクスとpprofを有効にします。`false`に設定すると、このパラメータはメトリクスとpprofを無効にします。

## `--run-ddl`

- `tidb-server`がDDLステートメントを実行しているかを確認し、クラスタ内の`tidb-server`の数が2つを超えた場合に設定します
- デフォルト: `true`
- 値は（true）または（false）です。（true）は`tidb-server`がDDLを実行していることを示し、（false）は`tidb-server`がDDLを実行していないことを示します。

## `--socket string`

- 外部接続のためのTiDBサービスがUnixソケットファイルを使用します
- デフォルト: `""`
- Unixソケットファイルを開くには、`/tmp/tidb.sock`を使用してください

## `--status`

- TiDBサーバのステータスレポートポート
- デフォルト: `"10080"`
- このポートはサーバ内部データを取得するために使用されます。データには[Prometheusメトリクス](https://prometheus.io/)と[pprof](https://golang.org/pkg/net/http/pprof/)が含まれます。
- Prometheusメトリクスは`"http://host:status_port/metrics"`でアクセスできます。
- `"http://host:status_port/debug/pprof"`でpprofデータにアクセスできます。

## `--status-host`

- TiDBサービスのステータスをモニタリングするために使用される`HOST`
- デフォルト：`0.0.0.0`

## `--store`

- TiDBがボトムレイヤで使用するストレージエンジンを指定します
- デフォルト：`"unistore"`
- "unistore"（ローカルストレージエンジン）または "tikv"（分散ストレージエンジン）を選択できます。

## `--temp-dir`

- TiDBの一時ディレクトリ
- デフォルト：`"/tmp/tidb"`

## `--token-limit`

- TiDBで同時に実行されるセッションの数を制限します。トラフィック制御に使用されます。
- デフォルト：`1000`
- 同時セッション数が`token-limit`より大きい場合、リクエストはブロックされ、完了した操作がトークンを解放するのを待ちます。

## `-V`

- TiDBのバージョンを出力します
- デフォルト：`""`

## `--plugin-dir`

+ プラグインのストレージディレクトリ
+ デフォルト：`"/data/deploy/plugin"`

## `--plugin-load`

+ カンマで区切られた各プラグインの名前
+ デフォルト：`""`

## `--affinity-cpus`

+ TiDBサーバーのCPUアフィニティをカンマで区切って設定します。例: "1,2,3"
+ デフォルト：`""`

## `--repair-mode`

+ 修復モードを有効にするかどうかを決定します。データ修復シナリオでのみ使用されます。
+ デフォルト：`false`

## `--repair-list`

+ 修復モードで修復されるテーブルの名前
+ デフォルト：`""`